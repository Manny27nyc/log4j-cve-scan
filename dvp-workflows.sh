#!/usr/bin/env bash
set -e

rm -f dvp-repos-*
split -l 250 --numeric-suffixes --suffix-length=2 --additional-suffix .txt dvp-repos.txt dvp-repos-

rm -f .github/workflows/dvp-*
for filename in ./dvp-repos-*.txt; do
  num="$(echo ${filename} | sed 's/[^0-9]*//g')"
  sed -e "s/@NUM@/$num/g" "./dvp-workflow-tpl.yml" > ".github/workflows/dvp-$num.yml"
done
